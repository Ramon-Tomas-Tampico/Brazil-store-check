<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Store Check – Form</title>

  <!-- === ESTILO BÁSICO (responsivo) ===================== -->
  <style>
    :root{
      --pink:#d6307a;
      --green:#28a745;
      --green-dark:#218838;
    }
    *{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
    body{
      margin:0;
      background:#f7f7f7;
      padding:16px;
    }
    h2{
      text-align:center;
      color:var(--pink);
    }
    form{
      max-width:600px;
      margin:auto;
      background:#fff;
      padding:20px;
      border-radius:12px;
      box-shadow:0 0 10px rgba(0,0,0,.08);
    }
    .block{margin-bottom:18px}
    .block label{font-weight:bold;margin-bottom:5px;display:block;color:#333}
    input[type=text],input[type=number]{
      width:100%;
      padding:10px;
      border:1px solid #ccc;
      border-radius:6px;
      margin-bottom:6px;
      font-size:15px;
    }
    button{
      width:100%;
      padding:14px;
      background:var(--green);
      color:#fff;
      border:none;
      border-radius:8px;
      font-size:17px;
      cursor:pointer;
    }
    button:hover{background:var(--green-dark)}
    .brand{margin-top:20px}
    .brand h3{margin:8px 0;color:var(--pink)}
    #msg{margin-top:14px;text-align:center;font-weight:bold}
  </style>
</head>

<body>
  <h2>Store Check Form</h2>

  <form id="storeForm">
    <!-- --------- dados básicos --------- -->
    <div class="block">
      <label for="storeName">Store Name</label>
      <input id="storeName" type="text" required>
    </div>

    <div class="block">
      <label for="city">City</label>
      <input id="city" type="text" required>
    </div>

    <!-- --------- blocos de preços --------- -->
    <div class="brand">
      <h3>Tampico</h3>
      <input class="tampico" type="number" placeholder="2 L">
      <input class="tampico" type="number" placeholder="1.5 L">
      <input class="tampico" type="number" placeholder="1 L">
      <input class="tampico" type="number" placeholder="450 ml">
      <input class="tampico" type="number" placeholder="250 ml">
      <input class="tampico" type="number" placeholder="200 ml">
      <input class="tampico" type="number" placeholder="Tetra 1 L">
      <input class="tampico" type="number" placeholder="Can">
    </div>

    <div class="brand">
      <h3>Del Valle Frut</h3>
      <input class="delvalle" type="number" placeholder="2 L">
      <input class="delvalle" type="number" placeholder="1.5 L">
      <input class="delvalle" type="number" placeholder="1 L">
      <input class="delvalle" type="number" placeholder="450 ml">
      <input class="delvalle" type="number" placeholder="250 ml">
      <input class="delvalle" type="number" placeholder="200 ml">
      <input class="delvalle" type="number" placeholder="Tetra 1 L">
      <input class="delvalle" type="number" placeholder="Can">
    </div>

    <div class="brand">
      <h3>Other Brand</h3>
      <input id="otherBrand" type="text" placeholder="Brand Name">
      <input class="other" type="number" placeholder="2 L">
      <input class="other" type="number" placeholder="1.5 L">
      <input class="other" type="number" placeholder="1 L">
      <input class="other" type="number" placeholder="450 ml">
      <input class="other" type="number" placeholder="250 ml">
      <input class="other" type="number" placeholder="200 ml">
      <input class="other" type="number" placeholder="Tetra 1 L">
      <input class="other" type="number" placeholder="Can">
    </div>

    <!-- campos ocultos p/ coordenadas -->
    <input id="lat" type="hidden">
    <input id="lng" type="hidden">

    <button type="submit">Send</button>
    <div id="msg"></div>
  </form>

  <!-- =================== SCRIPT ========================= -->
  <script>
  /* URL do seu Web App (copie do Apps Script) */
  const API = "https://script.google.com/macros/s/AKfycbzd1mNJljpYl5Ztr_jQA0uaJcQJ3RZb7PDIqD2I5JBUP0b83wc6oau3K-NDdNrcrFLt/exec";

  /* Geolocalização: preenche lat / lng */
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(p => {
      lat.value = p.coords.latitude;
      lng.value = p.coords.longitude;
    }, err => console.warn("Geolocation error:", err.message));
  }

  /* Envio do formulário -------------------------------- */
  storeForm.addEventListener("submit", async ev => {
    ev.preventDefault();
    msg.textContent = "Saving…";
    msg.style.color = "black";

    const payload = {
      storeName      : storeName.value.trim(),
      city           : city.value.trim(),
      latitude       : parseFloat(lat.value) || "",
      longitude      : parseFloat(lng.value) || "",
      tampico        : [...document.querySelectorAll(".tampico") ].map(i=>i.value.trim()),
      delValle       : [...document.querySelectorAll(".delvalle")].map(i=>i.value.trim()),
      otherBrandName : otherBrand.value.trim(),
      otherPrices    : [...document.querySelectorAll(".other")   ].map(i=>i.value.trim()),
      photos         : []  // futuro
    };

    const body = "data=" + encodeURIComponent(JSON.stringify(payload));

    try {
      const res  = await fetch(API, {
        method : "POST",
        headers: {"Content-Type":"application/x-www-form-urlencoded"},
        body
      });
      const json = await res.json();

      if (json.status === "OK") {
        msg.textContent = "Data saved ✓";
        msg.style.color = "green";
        ev.target.reset();
      } else {
        throw new Error(json.error || "Unknown error");
      }
    } catch (err) {
      msg.textContent = "Error: " + err.message;
      msg.style.color = "red";
      console.error(err);
    }
  });
  </script>
</body>
</html>
