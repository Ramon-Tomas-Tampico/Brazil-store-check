<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PDV Store Check – Form</title>

<style>
:root{
  --pink:#E75182; --green:#27d34d;
  --gap:10px; --radius:10px;
  --font-base:clamp(1rem, 3.5vw, 1.15rem);
  --font-h2:clamp(1.4rem, 5vw, 1.8rem);
}
body{
  font-family:-apple-system,Helvetica,Arial,sans-serif;
  margin:var(--gap);
  font-size:var(--font-base);
}
h2{
  font-size:var(--font-h2);
  color:var(--pink);
}
label{display:block;margin-top:var(--gap)}
input[type=text],input[type=number]{
  width:100%;padding:6px;
  border-radius:var(--radius);border:1px solid #ccc
}
fieldset{
  border:2px solid #ccc;border-radius:var(--radius);
  padding:var(--gap);margin-top:18px
}
legend{font-weight:700;color:var(--pink)}
button{
  margin-top:20px;background:var(--green);color:#fff;
  border:none;border-radius:var(--radius);
  padding:12px 28px;font-weight:700;font-size:1.1rem;
  cursor:pointer;width:100%
}
</style>
</head>
<body>

<h2>Point-of-Sale Registration</h2>

<form id="pdvForm">
  <!-- Basic info -->
  <label>Store Name</label>
  <input type="text" id="storeName" required>

  <label>City</label>
  <input type="text" id="city" required>

  <!-- Tampico block -->
  <fieldset>
    <legend>Tampico</legend>
    <label>2 L</label><input type="number" step="0.01" id="tampico_0">
    <label>1.5 L</label><input type="number" step="0.01" id="tampico_1">
    <label>1 L</label><input type="number" step="0.01" id="tampico_2">
    <label>450 ml</label><input type="number" step="0.01" id="tampico_3">
    <label>250 ml</label><input type="number" step="0.01" id="tampico_4">
    <label>200 ml</label><input type="number" step="0.01" id="tampico_5">
    <label>Tetra 1 L</label><input type="number" step="0.01" id="tampico_6">
    <label>Can</label><input type="number" step="0.01" id="tampico_7">
  </fieldset>

  <!-- Del Valle block -->
  <fieldset>
    <legend>Del Valle Frut</legend>
    <label>2 L</label><input type="number" step="0.01" id="delvalle_0">
    <label>1.5 L</label><input type="number" step="0.01" id="delvalle_1">
    <label>1 L</label><input type="number" step="0.01" id="delvalle_2">
    <label>450 ml</label><input type="number" step="0.01" id="delvalle_3">
    <label>250 ml</label><input type="number" step="0.01" id="delvalle_4">
    <label>200 ml</label><input type="number" step="0.01" id="delvalle_5">
    <label>Tetra 1 L</label><input type="number" step="0.01" id="delvalle_6">
    <label>Can</label><input type="number" step="0.01" id="delvalle_7">
  </fieldset>

  <!-- Other Brand block -->
  <fieldset>
    <legend>Other Brand</legend>
    <label>Brand Name</label>
    <input type="text" id="otherBrandName">

    <label>2 L</label><input type="number" step="0.01" id="other_0">
    <label>1.5 L</label><input type="number" step="0.01" id="other_1">
    <label>1 L</label><input type="number" step="0.01" id="other_2">
    <label>450 ml</label><input type="number" step="0.01" id="other_3">
    <label>250 ml</label><input type="number" step="0.01" id="other_4">
    <label>200 ml</label><input type="number" step="0.01" id="other_5">
    <label>Tetra 1 L</label><input type="number" step="0.01" id="other_6">
    <label>Can</label><input type="number" step="0.01" id="other_7">
  </fieldset>

  <!-- Photos -->
  <label>Photos (up to 4)</label>
  <input type="file" id="photo1" accept="image/*">
  <input type="file" id="photo2" accept="image/*">
  <input type="file" id="photo3" accept="image/*">
  <input type="file" id="photo4" accept="image/*">

  <button type="button" onclick="sendData()">Save Point-of-Sale</button>
  <p id="status"></p>
</form>

<script>
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbzd1mNJljpYl5Ztr_jQA0uaJcQJ3RZb7PDIqD2I5JBUP0b83wc6oau3K-NDdNrcrFLt/exec"; // <-- troque

function base64(file){
  return new Promise(r=>{
    if(!file){r("");return;}
    const fr=new FileReader();
    fr.onload=()=>r(fr.result.split(",")[1]);
    fr.readAsDataURL(file);
  });
}

async function sendData(){
  const status=document.getElementById("status");
  status.textContent="Sending…";

  // arrays
  const tampico=[...Array(8)].map((_,i)=>document.getElementById(`tampico_${i}`).value);
  const delvalle=[...Array(8)].map((_,i)=>document.getElementById(`delvalle_${i}`).value);
  const other  =[...Array(8)].map((_,i)=>document.getElementById(`other_${i}`).value);

  // photos
  const photos=[];
  for(let i=1;i<=4;i++){
    const file=document.getElementById(`photo${i}`).files[0];
    photos.push(await base64(file));
  }

  navigator.geolocation.getCurrentPosition(async pos=>{
    const data={
      storeName:document.getElementById("storeName").value,
      city:document.getElementById("city").value,
      latitude:pos.coords.latitude,
      longitude:pos.coords.longitude,
      tampico,
      delValle:delvalle,
      otherBrandName:document.getElementById("otherBrandName").value,
      otherPrices:other,
      photos
    };
    try{
      const res=await fetch(SCRIPT_URL,{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify(data)
      });
      const text=await res.text();
      status.textContent="Server: "+text;
    }catch(err){
      status.textContent="Error: "+err;
    }
  },()=>status.textContent="Location denied");
}
</script>
</body>
</html>
